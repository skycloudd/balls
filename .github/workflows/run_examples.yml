name: Run examples

on:
    push:
        branches: ["main"]
    pull_request:
        branches: ["main"]

env:
    CARGO_TERM_COLOR: always

jobs:
    build:
        strategy:
            fail-fast: false
            matrix:
                os: [ubuntu-latest, macos-latest, windows-latest]
                toolchain: [stable, beta, nightly]

        name: run examples ${{ matrix.os }} / ${{matrix.toolchain }}
        runs-on: ${{ matrix.os }}

        steps:
            - uses: actions/checkout@v4

            - uses: actions-rs/toolchain@v1
              with:
                  toolchain: ${{ matrix.toolchain }}
                  components: clippy
                  override: true

            - uses: Swatinem/rust-cache@v2

            - run: ./run.py
